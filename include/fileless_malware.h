#ifndef FILELESS_MALWARE_H
#define FILELESS_MALWARE_H

#include <iostream>
#include <string>
#include <vector>

namespace KernelScanner {

class FilelessMalwareDetector {
public:
    struct FilelessAnalysis {
        bool detected;
        std::string type;
        std::vector<std::string> indicators;
        std::vector<std::string> ps_script_blocks;
        std::vector<std::string> wmi_subscriptions;
        std::vector<std::string> scheduled_tasks;
        double malicious_score;
    };
    
    FilelessMalwareDetector();
    FilelessAnalysis scan_for_fileless();
    void print_fileless_report(const FilelessAnalysis& analysis);

private:
    std::vector<FilelessAnalysis> scans;
};

} // namespace KernelScanner

#endif
