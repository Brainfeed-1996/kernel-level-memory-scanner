#ifndef MALWARE_SANDBOX_H
#define MALWARE_SANDBOX_H

#include <iostream>
#include <string>
#include <vector>
#include <map>

namespace KernelScanner {

class MalwareSandbox {
public:
    struct SandboxResult {
        std::string malware_hash;
        std::string malware_family;
        std::map<std::string, bool> behaviors;
        std::vector<std::string> network_indicators;
        std::vector<std::string> file_operations;
        std::vector<std::string> registry_operations;
        int threat_level; // 0-100
    };
    
    MalwareSandbox();
    SandboxResult analyze_malware(const std::string& sample_path);
    void monitor_behavior();
    void generate_report(const SandboxResult& result);

private:
    std::vector<SandboxResult> analysis_history;
};

} // namespace KernelScanner

#endif
